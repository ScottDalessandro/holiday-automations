---
interface CodeItem {
  label: string;
  code: string;
}

interface Props {
  codeBlocks: CodeItem[];
}

const { codeBlocks } = Astro.props;
---

<div id="the-code" class="fade-up bg-slate-900/70 border border-slate-800 rounded-2xl p-8 backdrop-blur-sm scroll-mt-28">
    <div class="flex items-center gap-3 mb-6">
        <span class="text-2xl">&#128187;</span>
        <h2 class="text-xl font-bold text-white tracking-tight">The Code</h2>
    </div>

    <div class="space-y-6">
        {codeBlocks.map((block) => (
            <div>
                <div class="flex justify-between items-end mb-2">
                    <label class="text-xs font-semibold text-amber-400 uppercase tracking-wider">{block.label}</label>
                </div>
                <div class="bg-slate-950 rounded-xl p-4 border border-slate-800 relative group">
                    <code class="font-mono text-sm text-slate-300">{block.code}</code>
                    <button
                        class="copy-btn absolute top-2 right-2 text-slate-500 hover:text-white text-xs bg-slate-800 px-2 py-1 rounded opacity-0 group-hover:opacity-100 transition-opacity"
                        data-code={block.code}
                    >
                        Copy
                    </button>
                </div>
            </div>
        ))}
    </div>
</div>

<script>
document.querySelectorAll('.copy-btn').forEach((btn) => {
    btn.addEventListener('click', async () => {
        const code = btn.getAttribute('data-code');
        if (code) {
            await navigator.clipboard.writeText(code);
            const originalText = btn.textContent;
            btn.textContent = 'Copied!';
            setTimeout(() => {
                btn.textContent = originalText;
            }, 2000);
        }
    });
});
</script>

<style>
    .font-mono {
        font-family: 'JetBrains Mono', monospace;
    }
</style>
