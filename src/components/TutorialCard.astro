---
// Tutorial card component - pulls data from content collection
interface WorkflowNode {
    icon: string;
    label: string;
    color: 'emerald' | 'slate' | 'rose' | 'amber' | 'sky' | 'violet';
}

interface BonusIdea {
    title: string;
    description: string;
}

interface Props {
    number: number;
    emoji: string;
    title: string;
    description: string;
    difficulty: 'beginner' | 'intermediate' | 'advanced';
    workflowNodes: WorkflowNode[];
    shareWith: string;
    businessSkill: string;
    bonusIdeas: BonusIdea[];
    href: string;
}

const {
    number,
    emoji,
    title,
    description,
    difficulty,
    workflowNodes,
    shareWith,
    businessSkill,
    bonusIdeas,
    href
} = Astro.props;

const nodeColorClasses: Record<string, string> = {
    emerald: 'text-emerald-400',
    slate: 'text-white',
    rose: 'text-rose-400',
    amber: 'text-amber-400',
    sky: 'text-sky-400',
    violet: 'text-violet-400'
};

// Capitalize first letter for display
const difficultyDisplay = difficulty.charAt(0).toUpperCase() + difficulty.slice(1);

const difficultyColors: Record<string, string> = {
    'beginner': 'bg-emerald-600',
    'intermediate': 'bg-amber-600',
    'advanced': 'bg-rose-600'
};
---

<article class="fade-up flex flex-col h-full bg-slate-900/70 border border-slate-800 rounded-2xl p-8 hover:border-rose-500/40 hover:shadow-[0_0_40px_-10px_rgba(244,63,94,0.1)] hover:scale-[1.01] hover:-translate-y-2 transition-all duration-500 relative overflow-hidden group">
    <!-- Ribbon -->
    <div class="absolute top-5 right-5 z-20">
        <span class={`inline-block ${difficultyColors[difficulty]} text-white text-[10px] font-bold uppercase tracking-wider px-3 py-1 rounded-full shadow-lg`}>{difficultyDisplay}</span>
    </div>

    <div class="relative z-10">
        <div class="flex items-center gap-4 mb-4">
            <div class="w-12 h-12 rounded-xl bg-rose-500 text-white flex items-center justify-center font-bold text-lg shadow-lg shadow-rose-500/20">{number}</div>
            <span class="text-4xl">{emoji}</span>
        </div>
        <h4 class="text-2xl font-bold text-white mb-2 tracking-tight">{title}</h4>
        <p class="text-slate-400 mb-8">{description}</p>

        <!-- Workflow Diagram -->
        <div class="bg-slate-950/80 rounded-xl p-6 mb-8 border border-slate-800/50 flex flex-wrap gap-3 items-center justify-start overflow-hidden relative">
            <!-- Dashed Line BG -->
            <div class="absolute top-1/2 left-4 right-4 h-px border-t border-dashed border-slate-700 -translate-y-1/2 z-0"></div>

            {workflowNodes.map((node, index) => (
                <>
                    <div class={`relative z-10 bg-slate-800 border border-slate-700 ${nodeColorClasses[node.color]} px-3 py-2 rounded-lg flex items-center gap-2 text-xs font-medium shadow-sm`}>
                        <iconify-icon icon={node.icon} width="14"></iconify-icon> {node.label}
                    </div>
                    {index < workflowNodes.length - 1 && (
                        <iconify-icon icon="lucide:chevron-right" class="text-amber-400 relative z-10 text-xs"></iconify-icon>
                    )}
                </>
            ))}
        </div>

        <!-- Meta Data -->
        <div class="grid grid-cols-2 gap-6 mb-6">
            <div>
                <div class="text-rose-400 text-[10px] font-bold tracking-widest uppercase mb-1 opacity-80">üíù Share With</div>
                <div class="text-slate-300 text-sm font-medium">{shareWith}</div>
            </div>
            <div>
                <div class="text-rose-400 text-[10px] font-bold tracking-widest uppercase mb-1 opacity-80">üíº Business Skill</div>
                <div class="text-slate-300 text-sm font-medium">{businessSkill}</div>
            </div>
        </div>

        <!-- Bonus Box -->
        <div class="mt-auto mb-8 p-5 bg-amber-500/5 border border-dashed border-amber-500/30 rounded-xl">
            <h5 class="text-amber-400 font-semibold text-xs uppercase tracking-wide mb-3 flex items-center gap-2">
                <iconify-icon icon="lucide:sparkles" width="14"></iconify-icon>
                Bonus Ideas
            </h5>
            <ul class="space-y-2">
                {bonusIdeas.map((idea) => (
                    <li class="flex items-start gap-2 text-sm text-slate-400">
                        <span class="mt-0.5 text-xs">üéÅ</span> {idea.title}
                    </li>
                ))}
            </ul>
        </div>

        <a href={href} class="inline-flex items-center gap-2 text-rose-400 hover:text-rose-300 font-semibold transition-colors group/link">
            View Walkthrough
            <iconify-icon icon="lucide:arrow-right" width="18" class="group-hover/link:translate-x-1 transition-transform"></iconify-icon>
        </a>
    </div>
</article>
